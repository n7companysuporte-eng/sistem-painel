<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SaaS Estoque Simples</title>

<style>
:root {
  --roxo: #6c2bd9;
  --roxo-claro: #f3edff;
  --preto: #111;
  --cinza: #666;
  --branco: #fff;
}

* {
  box-sizing: border-box;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

body {
  margin: 0;
  background: #f6f6f9;
  color: var(--preto);
}

header {
  background: var(--roxo);
  color: white;
  padding: 16px;
  text-align: center;
  font-weight: 600;
}

main {
  padding: 16px;
  padding-bottom: 90px;
}

section {
  display: none;
}

section.active {
  display: block;
}

.card {
  background: white;
  border-radius: 16px;
  padding: 16px;
  margin-bottom: 16px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.05);
}

h3 {
  margin-top: 0;
  margin-bottom: 12px;
}

input, select, button, textarea {
  width: 100%;
  padding: 12px;
  margin-bottom: 10px;
  border-radius: 12px;
  border: 1px solid #ddd;
  font-size: 14px;
}

button {
  background: var(--roxo);
  color: white;
  border: none;
  font-weight: 600;
}

button.secondary {
  background: #eee;
  color: #333;
}

.list {
  font-size: 14px;
}

.item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 0;
  border-bottom: 1px solid #eee;
}

.item small {
  color: var(--cinza);
}

.remove {
  color: red;
  cursor: pointer;
  font-size: 12px;
}

nav {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: white;
  display: flex;
  border-top: 1px solid #ddd;
}

nav button {
  flex: 1;
  border-radius: 0;
  background: none;
  color: var(--cinza);
}

nav button.active {
  color: var(--roxo);
  font-weight: 700;
}
</style>
</head>

<body>

<header>
ðŸ“¦ Controle de Estoque
</header>

<main>

<!-- ENTRADA -->
<section id="entrada" class="active">
  <div class="card">
    <h3>âž• Entrada de Produto</h3>

    <input id="produtoEntrada" placeholder="Nome do produto">
    <input id="categoriaEntrada" placeholder="Categoria">
    <input id="quantidadeEntrada" type="number" placeholder="Quantidade">

    <button onclick="adicionarLancamento('entrada')">Salvar entrada</button>
  </div>
</section>

<!-- SAÃDA -->
<section id="saida">
  <div class="card">
    <h3>âž– SaÃ­da de Produto</h3>

    <input id="produtoSaida" placeholder="Nome do produto">
    <input id="categoriaSaida" placeholder="Categoria">
    <input id="quantidadeSaida" type="number" placeholder="Quantidade">

    <button onclick="adicionarLancamento('saida')">Salvar saÃ­da</button>
  </div>
</section>

<!-- HISTÃ“RICO -->
<section id="historico">
  <div class="card">
    <h3>ðŸ•’ HistÃ³rico de MovimentaÃ§Ãµes</h3>
    <div id="historicoLista" class="list"></div>
  </div>
</section>

<!-- ESTOQUE -->
<section id="estoque">
  <div class="card">
    <h3>ðŸ“¦ Estoque Atual</h3>
    <div id="estoqueLista" class="list"></div>
  </div>
</section>

<!-- ANALISE -->
<section id="analise">
  <div class="card">
    <h3>ðŸ“Š AnÃ¡lise por perÃ­odo</h3>

    <input type="date" id="dataInicio">
    <input type="date" id="dataFim">
    <input id="categoriaFiltro" placeholder="Categoria (opcional)">

    <button onclick="gerarRelatorio()">Gerar relatÃ³rio</button>
  </div>

  <div class="card">
    <h3>ðŸ“„ RelatÃ³rio</h3>
    <textarea id="relatorio" rows="12"></textarea>
    <button onclick="enviarWhats()">Enviar para WhatsApp</button>
  </div>
</section>

</main>

<nav>
  <button class="active" onclick="trocarAba('entrada', this)">Entrada</button>
  <button onclick="trocarAba('saida', this)">SaÃ­da</button>
  <button onclick="trocarAba('historico', this)">HistÃ³rico</button>
  <button onclick="trocarAba('estoque', this)">Estoque</button>
  <button onclick="trocarAba('analise', this)">AnÃ¡lise</button>
</nav>

<script>
let lancamentos = JSON.parse(localStorage.getItem("lancamentos")) || [];

function salvar() {
  localStorage.setItem("lancamentos", JSON.stringify(lancamentos));
}

function trocarAba(id, btn) {
  document.querySelectorAll("section").forEach(s => s.classList.remove("active"));
  document.getElementById(id).classList.add("active");

  document.querySelectorAll("nav button").forEach(b => b.classList.remove("active"));
  btn.classList.add("active");

  renderizar();
}

function adicionarLancamento(tipo) {
  const produto = document.getElementById(`produto${capitalize(tipo)}`).value;
  const categoria = document.getElementById(`categoria${capitalize(tipo)}`).value;
  const quantidade = Number(document.getElementById(`quantidade${capitalize(tipo)}`).value);

  if (!produto || !categoria || !quantidade) {
    alert("Preencha todos os campos");
    return;
  }

  lancamentos.push({
    id: Date.now(),
    produto,
    categoria,
    quantidade,
    tipo,
    data: new Date().toLocaleDateString("pt-BR")
  });

  salvar();
  renderizar();
}

function remover(id) {
  lancamentos = lancamentos.filter(l => l.id !== id);
  salvar();
  renderizar();
}

function renderizar() {
  // HistÃ³rico
  historicoLista.innerHTML = "";
  lancamentos.slice().reverse().forEach(l => {
    historicoLista.innerHTML += `
      <div class="item">
        <div>
          <strong>${l.produto}</strong><br>
          <small>${l.categoria} â€¢ ${l.tipo} â€¢ ${l.data}</small>
        </div>
        <div>
          ${l.quantidade}
          <div class="remove" onclick="remover(${l.id})">remover</div>
        </div>
      </div>`;
  });

  // Estoque
  const estoque = {};
  lancamentos.forEach(l => {
    if (!estoque[l.produto]) estoque[l.produto] = {categoria:l.categoria, total:0};
    estoque[l.produto].total += l.tipo === "entrada" ? l.quantidade : -l.quantidade;
  });

  estoqueLista.innerHTML = "";
  Object.keys(estoque).forEach(p => {
    estoqueLista.innerHTML += `
      <div class="item">
        <div>
          <strong>${p}</strong><br>
          <small>${estoque[p].categoria}</small>
        </div>
        <strong>${estoque[p].total}</strong>
      </div>`;
  });
}

function gerarRelatorio() {
  const inicio = new Date(dataInicio.value);
  const fim = new Date(dataFim.value);
  const cat = categoriaFiltro.value;

  let filtrado = lancamentos.filter(l => {
    const d = new Date(l.data.split("/").reverse().join("-"));
    return (!cat || l.categoria === cat) && d >= inicio && d <= fim;
  });

  let texto = `ðŸ“¦ RELATÃ“RIO DE ESTOQUE\n\n`;
  texto += `PerÃ­odo: ${dataInicio.value} a ${dataFim.value}\n`;
  if (cat) texto += `Categoria: ${cat}\n\n`;

  filtrado.forEach(l => {
    texto += `${l.data} â€¢ ${l.produto} â€¢ ${l.tipo} â€¢ ${l.quantidade}\n`;
  });

  relatorio.value = texto;
}

function enviarWhats() {
  const texto = encodeURIComponent(relatorio.value);
  window.open(`https://wa.me/?text=${texto}`, "_blank");
}

function capitalize(text) {
  return text.charAt(0).toUpperCase() + text.slice(1);
}

renderizar();
</script>

</body>
</html>
